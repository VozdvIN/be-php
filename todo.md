# Концептуально

~ В первую очередь привести в порядок страницы, актуальные для игроков

~ Максимальное количество запросов к БД, в том числе и специальных, перенести в модель

~ Ссылки между страницами, не связанные с изменением данных, выделять рамками без цветового выделения

~ Все ссылки с изменением данных выделять цветом

# BUG

! Настроить запоминание сессии на большое время (день)

! Исключение при попытке подать заявку в команду повторно

Некорректно работает разметка в комментариях к полям форм

? Автор игры не может сменить команду организатора на ту, в которой он не капитан (при записи игры не проходит проверка на право изменений)

# Improvement

## Текущее

Анонсирование игры сделать через дополнительное состояние игры между PLANNED и VERIFY.

Убрать возможность смены команды-автора игры самими авторами.

Упразднить разные виды модераторов.

Реализовать полномочия модератора проекта:
    полные права на управление всеми командами проекта (аналогично их капитанам);
    полные права на управление всеми играми проекта (аналогично их авторам);

Подсказки к полям форм показывать только на больших экранах (>800px)

Формы по возможности показывать с меню, к которым они относятся

Управление игрой: отдельные страницы меню для больших списков действий (с игрой, заданием команды и т.п.)

Код таймеров размещать непосредственно в месте использования

Убрать лишние подтверждения на формах и ссылках переходов

Упразднить BBCode, разрешить использование HTML

Страница задания: отображение времени до ближайшего ключевого момента и автообновление при его достижении

Возвраты на предыдущие страницы сделать с использованием referrer
    - убрать все, связанное с retUrl и аналогами

Убрать возможность пропуска задания (и инструменты капитана тоже)

## С доработкой БД

Убрать флажок анонса игры.

Убрать все, связанное со статьями.
    - Временно оставить структуры, позволяющие выводить шапку, главную и подвал.

Убрать ручной старт задания

Убрать приоритет задания "когда занято" (покомандного достаточно)

Автоматический прием заявок на игру, т.е. без подтверждения

Разрешение просмотра предварительных итогов игры до ее финиша

Текст главной страницы, шапки и подвала разместить в таблице региона/проекта и редактировать вместе с ним

Собственные приоритеты заданий в раздел "шаблоны" игры

Задания-заглушки

Бонус за выполнение задания:
    очки - как корректировка итогов игры
    время:
        - как корректировка итогового времени игры
        - как корректировка доступного игрового времени

Штраф за провал задания:
    очки - как корректировка итогов игры
    время:
        - как корректировка итогов игры
        - как корректировка доступного игрового времени

Бонус за взятие кода:
    очки - как корректировка итогов игры
    время:
        - как корректировка итогов игры
        - как корректировка доступного времени задания

Бонусные (необязательные) коды

Варианты написания кода (хранить построчно в текстовом поле)

Коды с пробелами

Корректирующие бонусы/штрафы по очкам/времени после игры

Для пользователя хранить:
    - дату регистрации,
    - дату последнего входа,
    - дату последней блокировки,
    - число последовательных неудачных попыток входа

Блокировать пользователя за несколько подряд неудачных попыток входа

# Доработка структуры меню

## + Структура основного меню и первого подуровня:
    + (проект) - заголовок; выбор текущего проекта
    + Игры
    + Команды
    + Профиль - профиль текущего пользователя
    + Участники
    + Модерирование

## Структуры подразделов главного меню:

### Игры
    // Игры, находящиеся в разработке не видны. Доступ к ним есть у авторов через "Профиль/игры/организатор" и у модератора через "Мдерирование".
    + ^ - возврат на главную
    + Игры - заголовок; полный список игр текущего проекта
    Заявки - только модератор проекта или администратор; все заявки на создание игр только от команд проекта.
    Разработка - только модератор проекта или администратор; все игры, которые не анонсированы
    + Анонсы - список анонсированных игр текущего проекта
    + Активные - список активных игр текущего проекта
    + Завершены - список завершенных игр текущего проекта

### + Команды
    + ^ - возврат на главную
    + Команды - заголовок; полный список команд текущего проекта
        Заявки - только модератор проекта или администратор; все заявки на создание команд только от пользователей проекта.

### Участники
    + ^ - возврат на главную
    + Участники - заголовок; полный список неблокированных участников текущего проекта
        Блокированы - только администратор; список блокированых участников проекта

### Модерирование
    //Все данные раздела - без учета проекта.
    Настройки - только администратор;
    Проекты - только администратор;
    Участники - только администратор;
        Активные - перечень активных пользователей
        Блокированы - перечень заблокированных пользователей
    Команды - только администратор;
        Все - все команды в системе
        Заявки - все заявки в системе
    Игры - только администратор;
        Заявки // Управление всеми заявками на создание игр
        Все // Полный список игр по проектам
        Разрабатываются // Не анонсированные игры
        Анонсы // Анонсированные игры
        Активные // Активные игры
        Завершены // Архивированные игры

## Структуры меню отдельных сущностей:

### Пользователь // все нижележащие данные - без учета текущего проекта
    + ^ - возврат к списку участников
    (логин_пользователя) - заголовок; основная анкета
        // Кнопка редактирования анкеты
        // Только собственная анкета - кнопка смены пароля
        // Только администратор - кнопка удаления пользователя
        // Только администратор - кнопка смены состояния блокировки пользователя
    + Команды - список команд, в которых пользователь состоит
        + Заявки - список команд, в состав которых поданы заявки
        + Игрок - список команд, в которых пользователь состоит как игрок
        + Капитан - список команд, в которых пользователь состоит как капитан
        Создание - список заявок на создание команды, поданных пользователем
            // Только собственная анкета - кнопка подачи заявки на создание команды
            // Только собственная анкета - кнопки отмены поданных заявок на создание команд
    + Игры - данные об играх, к которым пользователь имеет отношение
        + Игрок - список игр, в которых пользователь принимал, принимает или будет принимать участие
        + Организатор - список игр, к организации которых пользователь имеет отношение, без учета проекта
    Права - перечень прав или запретов пользователя
        // Только администратор - кнопки отзыва прав и запретов
        // Только администратор - кнопка назначения права или запрета
    + Выход - выход с сайта

### Команда // все нижележащие данные - без учета текущего проекта
    + ^ - возврат к списку команд
    + (название_команды_краткое) - заголовок; описание команды
    Состав - ...
        Список - перечень участников команды
            // Только капитан и только для игроков - кнопки повышения игрока до капитана
            // Только капитан и только для капитанов - кнопки понижения капитана до игрока
            // Только капитан - кнопка удаления игрока из состава
            // Только текущий пользователь только при участии в команде - кнопка выхода из команды
            // Только модератор проекта - кнопка включения произвольного пользователя в состав
        Заявки - перечень поданных заявок
            // Кнопка подачи заявки в состав текущим пользователем
            // Только текущий пользователь только при наличии заявки в эту команду - кнопка отмены своей заявки
            // Только капитан - кнопки принятия заявок
            // Только капитан - кнопки отмены заявок
    + Игры - список игр, в которых команда принимает или принимала участие
    + Организация - ...
        + Игры - список игр, которые команда организовала или организует
        Заявки - список заявок на создание игры, поданных командой
            // Только капитан - кнопки отмены заявок на создание игры
            // Только капитан - кнопка подачи заявки на создание игры

### Игра - участие, модуль game
    + ^ - возврат к списку игр
    + (название_игры) - заголовок; анонс игры
    Регистрация - список команд, зарегистрированных на игру и подавших заявку
        // Только до старта игры - кнопка подачи заявки на игру
        // Только для команд подавших заявки и подконтрольных текущему пользователю - кнопки отмены заявок на игру
        // Только модератор проекта - кнопка принудительной регистрации команды на игру
    + Итоги - только после завершения игры - итоги игры
        + Места - сводная таблица
        + Телеметрия - подробный отчет о действиях команд на заданиях
    + Редактор> - только автор игры - переход в редактор

### + Игра - редактор, модуль gameEdit
    + ^ - возврат к анонсу игры (для участников)
    + (название_игры) - заголовок; общие параметры игры
    + Команды - список зарегистрированных команд
    + Параметры - служебные параметры игры
    + Шаблоны - параметры новых заданий по-умолчанию
    + Задания - ...
        + Список - список заданий с основными их параметрами
            // Кнопка создания задания
        + Приоритеты - сводная таблица приоритетов заданий
        + Переходы - сводная таблица приоритетов переходов между заданиями
        + Фильтры - сводная таблица фильтров перехода между заданиями
    + Управление> - переход на страницу управления игрой

### + Задание
    + ^ - возврат к списку заданий игры
    + (название_задания_внутреннее) - заголовок, параметры задания
    + Подсказки
    + Ответы
    + Переходы
    + Фильтры

### Управление игрой, модуль gameControl
    ^ - возврат к редактору игры
    Пилот
        //Показывает статус текущих заданий
    Штурман
        Задания - последние, текущие и указание следующих заданий команд
        Карта - информация об игровой ситуации
    Бортмеханик - подробные данные о текущем статусе игры, команд и текущих заданий
        Задания - подробные данные о заданиях, ручное управление заданиями.
        Игра - подробные данные об игре, ручное управление игрой.